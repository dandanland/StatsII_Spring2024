anova(alexandria_turnout_1, alexandria_turnout_3, test = "Chisq")
# Residual analysis and outlier detection
par(mfrow = c(2, 2))
plot(alexandria_turnout_3)
# Model goodness of fit test
hoslem.test(alexandria_turnout_3$y, fitted(alexandria_turnout_3), g=10)
# Check for multicollinearity
vif(alexandria_turnout_3)
# Plot age and agelog
par(mfrow = c(1, 2))
hist(alexandria_data$age, main = "Age")
hist(alexandria_data$agelog, main = "Log(Age)")
alexandria_controls_without_age <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"midstatus",   # Mid-status occupation , categorical 0/1
"highstatus",  # High-status occupation, categorical 0/1
"owner",       # Owns home? , categorical 0/1
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 4
# Basline model:only personal attributes as explanatory variables.
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_without_age)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_4)
# TABLE 1, MODEL 5
# Add z1ev: an individual’s weighted eigenvector network centrality
alexandria_turnout_5 <- paste("turnout ~ ",
alexandria_controls_without_age,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_5)
# TABLE 1, MODEL 6
# Add z1ev:an individual’s weighted eigenvector network centrality
# and z1elite_avgprox: measure of elite proximity.
alexandria_turnout_6 <- paste("turnout ~ ",
alexandria_controls_without_age,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_6)
# Model goodness of fit test
hoslem.test(alexandria_turnout_6$y, fitted(alexandria_turnout_6), g=10)
# Check for multicollinearity again
vif(alexandria_turnout_6)
# Model goodness of fit test
hoslem.test(alexandria_turnout_1$y, fitted(alexandria_turnout_3), g=10)
hoslem.test(alexandria_turnout_2$y, fitted(alexandria_turnout_3), g=10)
hoslem.test(alexandria_turnout_3$y, fitted(alexandria_turnout_3), g=10)
# Check for multicollinearity
vif(alexandria_turnout_3)
# Model goodness of fit test
hoslem.test(alexandria_turnout_1$y, fitted(alexandria_turnout_1), g=10)
hoslem.test(alexandria_turnout_2$y, fitted(alexandria_turnout_2), g=10)
hoslem.test(alexandria_turnout_3$y, fitted(alexandria_turnout_3), g=10)
# Check for multicollinearity
vif(alexandria_turnout_3)
# Add midstatus interaction term for z1ev and z1elite_avgprox
# TABLE 1, MODEL 4
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"z1ev + midstatus:z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
# Add midstatus interaction term for z1ev and z1elite_avgprox
# TABLE 1, MODEL 4
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + midstatus:z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_4)
# TABLE 1, MODEL 5
alexandria_turnout_5 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_5)
# TABLE 1, MODEL 6
alexandria_turnout_6 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox + midstatus:z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_6)
# Add highstatus interaction term for z1ev and z1elite_avgprox
# TABLE 2, MODEL 7
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + highstatus:z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# Add highstatus interaction term for z1ev and z1elite_avgprox
# TABLE 2, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + highstatus:z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox + highstatus:z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_9)
# Table 1
list(
alexandria_turnout_1,
alexandria_turnout_2,
alexandria_turnout_3,
alexandria_turnout_4,
alexandria_turnout_5,
alexandria_turnout_6
)  %>%
screenreg(digits = 3,
stars = .05)
# Table 2
list(
alexandria_turnout_1,
alexandria_turnout_2,
alexandria_turnout_3,
alexandria_turnout_7,
alexandria_turnout_8,
alexandria_turnout_9
)  %>%
screenreg(digits = 3,
stars = .05)
# Model goodness of fit test
hoslem.test(alexandria_turnout_4$y, fitted(alexandria_turnout_4), g=10)
hoslem.test(alexandria_turnout_5$y, fitted(alexandria_turnout_5), g=10)
hoslem.test(alexandria_turnout_6$y, fitted(alexandria_turnout_6), g=10)
hoslem.test(alexandria_turnout_7$y, fitted(alexandria_turnout_7), g=10)
hoslem.test(alexandria_turnout_8$y, fitted(alexandria_turnout_8), g=10)
hoslem.test(alexandria_turnout_9$y, fitted(alexandria_turnout_9), g=10)
View(alexandria_data)
knitr::opts_chunk$set(echo = TRUE)
# Remove all objects from the workspace
rm(list = ls())
# LOAD PACKAGES
library(readr)   # readr_1.0.0: READ IN DATA WITH 'read_tsv()'
library(dplyr)   # dplyr_0.5.0: HELPER FUNCTIONS, e.g., '%>%'
library(texreg)  # texreg_1.36.7: PRINT SUMMARIES OF DATA WITH 'screenreg()'
library(MASS) # For VIF
library(car)  # Diagnostic plot for Logit model
library(ResourceSelection) # For Hosmer-Lemeshow test
# Set currency working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
alexandria_data <- read_tsv("Alexandria_Data.tsv")
alexandria_controls_with_nl <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"midstatus",   # Mid-status occupation , categorical 0/1
"highstatus",  # High-status occupation, categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# MODEL 1
# Basline model:only personal attributes as explanatory variables.
alexandria_turnout_1 <- paste("turnout ~ ",
alexandria_controls_with_nl)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_1)
# MODEL 2
# Add z1ev: an individual’s weighted eigenvector network centrality
alexandria_turnout_2 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_2)
# MODEL 3
# Add z1ev:an individual’s weighted eigenvector network centrality
# and z1elite_avgprox: measure of elite proximity.
alexandria_turnout_3 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_3)
# Perform sensitivity test, make sure adding network variables is significant
# These relationships are powerful in confounding the clustering of interests and environmental impacts within the network.
anova(alexandria_turnout_1, alexandria_turnout_3, test = "Chisq")
# Residual analysis and outlier detection
par(mfrow = c(2, 2))
plot(alexandria_turnout_3)
# Model goodness of fit test
hoslem.test(alexandria_turnout_1$y, fitted(alexandria_turnout_1), g=10)
hoslem.test(alexandria_turnout_2$y, fitted(alexandria_turnout_2), g=10)
hoslem.test(alexandria_turnout_3$y, fitted(alexandria_turnout_3), g=10)
# Check for multicollinearity
vif(alexandria_turnout_3)
# Create 'statuslevel' based on 'midstatus' and 'highstatus'
data$statuslevel <- ifelse(data$midstatus == 1, "middle status",
ifelse(data$highstatus == 1, "high status", "non-status"))
# Create 'statuslevel' based on 'midstatus' and 'highstatus'
alexandria_data$statuslevel <- ifelse(alexandria_data$midstatus == 1, "middle status",
ifelse(alexandria_data$highstatus == 1, "high status", "non-status"))
# Convert 'statuslevel' to an ordered factor
alexandria_data$statuslevel <- factor(alexandria_data$statuslevel, levels = c("non-status", "middle status", "high status"), ordered = TRUE)
# Add midstatus interaction term for z1ev and z1elite_avgprox
# TABLE 1, MODEL 4
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"statuslevel")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
# Add midstatus interaction term for z1ev and z1elite_avgprox
# TABLE 1, MODEL 4
alexandria_turnout_4 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ statuslevel")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
# TABLE 1, MODEL 5
alexandria_turnout_5 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + statuslevel")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_5)
# TABLE 1, MODEL 6
alexandria_turnout_6 <- paste("turnout ~ ",
alexandria_controls_with_nl,
"+ z1ev + z1elite_avgprox + statuslevel")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_6)
new_controls <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"statuslevel", # Mid-status occupation , categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
new_controls)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
new_controls,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
new_controls,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_)
new_controls <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"statuslevel", # Mid-status occupation , categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
new_controls)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
new_controls,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
new_controls,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_9)
# Table 1
list(
alexandria_turnout_1,
alexandria_turnout_2,
alexandria_turnout_3,
alexandria_turnout_4,
alexandria_turnout_5,
alexandria_turnout_6
)  %>%
screenreg(digits = 3,
stars = .05)
# Table 2
list(
alexandria_turnout_1,
alexandria_turnout_2,
alexandria_turnout_3,
alexandria_turnout_7,
alexandria_turnout_8,
alexandria_turnout_9
)  %>%
screenreg(digits = 3,
stars = .05)
# Create 'statuslevel' based on 'midstatus' and 'highstatus'
alexandria_data$statuslevel <- ifelse(alexandria_data$midstatus == 1, "middle status",
ifelse(alexandria_data$highstatus == 1, "high status", "non-status"))
# Convert 'statuslevel' to an ordered factor
alexandria_data$statuslevel <- factor(alexandria_data$statuslevel, levels = c("non-status", "middle status", "high status"), ordered = TRUE)
new_controls <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"statuslevel", # Mid-status occupation , categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
new_controls)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
new_controls,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
new_controls,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_9)
# Perform sensitivity test, make sure adding network variables is significant
# These relationships are powerful in confounding the clustering of interests and environmental impacts within the network.
anova(alexandria_turnout_1, alexandria_turnout_3, test = "Chisq")
# Residual analysis and outlier detection
par(mfrow = c(2, 2))
plot(alexandria_turnout_3)
# Model goodness of fit test
hoslem.test(alexandria_turnout_1$y, fitted(alexandria_turnout_1), g=10)
hoslem.test(alexandria_turnout_2$y, fitted(alexandria_turnout_2), g=10)
hoslem.test(alexandria_turnout_3$y, fitted(alexandria_turnout_3), g=10)
# Check for multicollinearity
vif(alexandria_turnout_3)
# Create 'statuslevel' based on 'midstatus' and 'highstatus'
alexandria_data$statuslevel <- ifelse(alexandria_data$midstatus == 1, "middle status",
ifelse(alexandria_data$highstatus == 1, "high status", "non-status"))
# Convert 'statuslevel' to an ordered factor
alexandria_data$statuslevel <- factor(alexandria_data$statuslevel, levels = c("non-status", "middle status", "high status"), ordered = TRUE)
new_controls <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"statuslevel", # Mid-status occupation , categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
new_controls)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
new_controls,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
new_controls,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_9)
new_controls <- c(
"hhwealth",    # Household wealth (thousands of dollars)" , continous
"hhwealthlog", # ln(Household wealth) , continous
"statuslevel", # Mid-status occupation , categorical 0/1
"owner",       # Owns home? , categorical 0/1
"age",         # Age (years) , continous
"agelog",      # ln(Age) , continous
"church",      # Is church member? , categorical 0/1
"usborn"       # Is U.S. born? , categorical 0/1
) %>%
paste(collapse = " + ")
# TABLE 1, MODEL 7
alexandria_turnout_7 <- paste("turnout ~ ",
new_controls)  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_7)
# TABLE 2, MODEL 8
alexandria_turnout_8 <- paste("turnout ~ ",
new_controls,
"+ z1ev")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_8)
# TABLE 2, MODEL 9
alexandria_turnout_9 <- paste("turnout ~ ",
new_controls,
"+ z1ev + z1elite_avgprox")  %>%
formula()  %>%
glm(data = alexandria_data,
family = binomial(link = "logit"))
summary(alexandria_turnout_9)
# # Table 1
# list(
#   alexandria_turnout_1,
#   alexandria_turnout_2,
#   alexandria_turnout_3,
#   alexandria_turnout_4,
#   alexandria_turnout_5,
#   alexandria_turnout_6
# )  %>%
#   screenreg(digits = 3,
#             stars = .05)
# Table 2
list(
alexandria_turnout_1,
alexandria_turnout_2,
alexandria_turnout_3,
alexandria_turnout_7,
alexandria_turnout_8,
alexandria_turnout_9
)  %>%
screenreg(digits = 3,
stars = .05)
# Model goodness of fit test
# hoslem.test(alexandria_turnout_4$y, fitted(alexandria_turnout_4), g=10)
# hoslem.test(alexandria_turnout_5$y, fitted(alexandria_turnout_5), g=10)
# hoslem.test(alexandria_turnout_6$y, fitted(alexandria_turnout_6), g=10)
hoslem.test(alexandria_turnout_7$y, fitted(alexandria_turnout_7), g=10)
hoslem.test(alexandria_turnout_8$y, fitted(alexandria_turnout_8), g=10)
hoslem.test(alexandria_turnout_9$y, fitted(alexandria_turnout_9), g=10)
anova(alexandria_turnout_7, alexandria_turnout_9, test = "Chisq")
anova(alexandria_turnout_3, alexandria_turnout_9, test = "Chisq")
